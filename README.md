# performanceTesting

## There are 2 version of plans(IR) files located in optimizedPlans and unOptimizedPlans directory. 
* optimizedPlans are generated by using partial evaluation with help of o=1 flag
* unpOptimizedPlans are is dependent on unknown variables. 

## run prometheus service and grafana service using docker-compose 
* go to directory of grafana-prometheus
* docker-compose build --no-cache 
* docker-compose up 

## configure java applications 
* baseDir="<path To optimizedPlans>" for eg: grafana-prometheus/opa/optimizedPlans/

## compile java application
* mvn clean install 

## do batch testing / execute jar application 
* java -jar target/performanceTesting.jar JARL 9081 70000
* java -jar target/performanceTesting.jar OPA 9080 70000

## Grafana Dashboard
* Grafana is available on localhost:3000 
* import grafana dashboard using dashaboard.json

## promql
* rate(opa_decision_latency_seconds_sum[2m])/rate(opa_decision_latency_seconds_count[2m])

* rate(jarl_authorization_decision_latency_seconds_sum[2m])/rate(jarl_authorization_decision_latency_seconds_count[2m])
